name: 'weather'
on: push
jobs:
  weather:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
      - name: get prismic data
        uses: seanmart/query-prismic-data-action@master
        id: get-prismic-data
        with:
          ACCESS_TOKEN: ${{secrets.PRISMIC_ACCESS_TOKEN}}
          END_POINT: ${{secrets.PRISMIC_END_POINT}}
          TYPE: event
          FIELDS: id:uid,latitude:data.map.latitude,longitude:data.map.longitude
      - name: get weather data
        uses: seanmart/get-open-weather-action@master
        with:
          API_KEY: ${{secrets.WEATHER_ACCESS_TOKEN}}
          EXCLUDE: 'minutely,hourly,daily,alerts'
          COORDINATES: ${{steps.get-prismic-data.outputs.DATA}}
